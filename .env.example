# =============================================================================
# Cost Watchdog - Environment Configuration
# =============================================================================
# Copy this file to .env and fill in the values.
# NEVER commit .env files to version control!
# =============================================================================

# -----------------------------------------------------------------------------
# Database (PostgreSQL)
# -----------------------------------------------------------------------------
# Required in production. For local dev, matches docker-compose.yml defaults.
DATABASE_URL="postgresql://cost_watchdog:cost_watchdog_dev@localhost:5432/cost_watchdog?schema=public"
# Optional: Enable Prisma query logging in development (set to "true" to enable)
# PRISMA_LOG_QUERIES="true"

# -----------------------------------------------------------------------------
# Redis (for BullMQ job queues)
# -----------------------------------------------------------------------------
# Required in production. For local dev, matches docker-compose.yml defaults.
REDIS_URL="redis://localhost:6379"

# -----------------------------------------------------------------------------
# S3/MinIO (Document Storage)
# -----------------------------------------------------------------------------
# All S3_* variables are REQUIRED in production.
# For local dev, defaults point to MinIO from docker-compose.yml.
S3_ENDPOINT="http://localhost:9000"
S3_BUCKET="cost-watchdog"
S3_ACCESS_KEY="minio_admin"
S3_SECRET_KEY="minio_admin_dev"
S3_REGION="eu-central-1"

# -----------------------------------------------------------------------------
# Authentication & Security
# -----------------------------------------------------------------------------
# REQUIRED: Minimum 32 characters. Generate with: openssl rand -base64 32
# This is used for JWT signing and cookie encryption.
AUTH_SECRET="your-secret-here-min-32-chars-long"

# Optional: Separate secret for cookies (defaults to AUTH_SECRET if not set)
# COOKIE_SECRET="another-secret-here-min-32-chars"

# Field encryption key (required in production for MFA and sensitive data)
# Generate with: openssl rand -base64 32
FIELD_ENCRYPTION_KEY="base64-encoded-32-byte-key"
# Optional: key version for rotation (default: 1)
# FIELD_ENCRYPTION_KEY_VERSION="1"

# Optional: Email address for the initial admin user
# The first user to register with this email will become an admin.
# If not set, all users will be created as 'viewer' role.
# INITIAL_ADMIN_EMAIL="admin@example.com"

# App URL for CORS configuration
AUTH_URL="http://localhost:3000"

# -----------------------------------------------------------------------------
# LLM Integration (for PDF extraction fallback)
# -----------------------------------------------------------------------------
# Optional: Only needed if using LLM-based document extraction
ANTHROPIC_API_KEY="sk-ant-..."

# -----------------------------------------------------------------------------
# Email (Resend)
# -----------------------------------------------------------------------------
# Optional: Only needed for email alerts
RESEND_API_KEY="re_..."
EMAIL_FROM="noreply@costwatchdog.com"
EMAIL_REPLY_TO="support@costwatchdog.com"

# -----------------------------------------------------------------------------
# Application
# -----------------------------------------------------------------------------
NODE_ENV="development"
API_URL="http://localhost:3001"
WEB_URL="http://localhost:3000"
# Next.js public API base URL (baked into the web bundle)
NEXT_PUBLIC_API_URL="http://localhost:3001/api/v1"

# -----------------------------------------------------------------------------
# Daily Digest
# -----------------------------------------------------------------------------
# Optional: Digest scheduler tuning (defaults shown)
DAILY_DIGEST_POLL_INTERVAL_MS="60000"
DAILY_DIGEST_MAX_ATTEMPTS="3"
DAILY_DIGEST_RUN_ON_STARTUP="false"

# -----------------------------------------------------------------------------
# Data Retention
# -----------------------------------------------------------------------------
# Optional: Retention policy tuning (defaults shown)
RETENTION_OUTBOX_DAYS="30"
RETENTION_DAILY_DIGEST_DAYS="30"
RETENTION_LOGIN_ATTEMPT_DAYS="90"
RETENTION_PASSWORD_RESET_DAYS="7"
RETENTION_AUDIT_LOG_DAYS="365"
RETENTION_ARCHIVE_AUDIT_LOGS="false"
RETENTION_BATCH_SIZE="1000"
RETENTION_CRON_SCHEDULE="0 3 * * *"
RETENTION_RUN_ON_STARTUP="false"
RETENTION_TIMEZONE="UTC"

# =============================================================================
# Production Checklist:
# =============================================================================
# Before deploying to production, ensure:
# [ ] AUTH_SECRET is a strong, unique secret (32+ chars)
# [ ] DATABASE_URL points to managed PostgreSQL (e.g., RDS, Cloud SQL)
# [ ] REDIS_URL points to managed Redis (e.g., ElastiCache, Memorystore)
# [ ] S3_* variables point to real S3/compatible storage with proper IAM
# [ ] NODE_ENV is set to "production"
# [ ] All secrets are injected via secrets manager, not .env files
# =============================================================================
